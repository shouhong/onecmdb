<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=koi8-r">
   <meta http-equiv="Content-Language" content="ru">
   <meta name="GENERATOR" content="Microsoft FrontPage 4.0">
   <meta name="ProgId" content="FrontPage.Editor.Document">
   <title>Сетевой сканер Nmap - руководство
   пользователя.</title>
</head>
<body>

<hr>
<p><b><font face="Times New Roman"><font size=+2>Сетевой сканер Nmap. Руководство
пользователя.</font></font></b>
<br>
<hr>
<p><b><font face="Times New Roman"><font size=+1>НАЗВАНИЕ</font></font></b>
<dir>
<dir><font face="Times New Roman">Nmap - the Network Mapper. Утилита для
сканирования и исследования безопасности сети.</font>
<p><font face="Times New Roman">Версия 2.54 beta 4.</font></p>
</dir>
</dir>
<b><font face="Times New Roman"><font size=+1>ИСПОЛЬЗОВАНИЕ</font></font></b>
<dir>
<dir><b>nmap</b><font face="Times New Roman"> [Метод(ы) сканирования] [Опции]
&lt;Хост или сеть #1,[#N]></font></dir>
</dir>
<b><font face="Times New Roman"><font size=+1>ОПИСАНИЕ</font></font></b>
<dir>
<dir><font face="Times New Roman">Программа Nmap предназначена для сканирования
сетей с любым количеством объектов, определения состояния объектов сканируемой
сети а также портов и соответствующих им служб. Для этого Nmap использует
много различных методов сканирования, таких, как UDP, TCP connect(), TCP
SYN (полуоткрытое), FTP proxy (прорыв через ftp), Reverse-ident, ICMP (ping),
FIN, ACK, Xmas tree, SYN и NULL-сканирование. Более подробное их описание
приведено в разделе "Опции выбора методов сканирования".</font>
<p><font face="Times New Roman">Nmap также поддерживает большой набор дополнительных
возможностей, а именно: определение операционной системы (далее - ОС) удаленного
хоста с использованием отпечатков стека TCP/IP, "невидимое" сканирование,
динамическое вычисление времени задержки и повтор передачи пакетов, параллельное
сканирование, определение неактивных хостов методом параллельного ping-опроса,
сканирование с использованием ложных хостов, определение наличия пакетных
фильтров, прямое (без использования portmapper) RPC-сканирование, сканирование
с использованием IP-фрагментации а также произвольное указание IP-адресов
и номеров портов сканируемых сетей.</font>
<p><font face="Times New Roman">Результатом работы Nmap является список
отсканированных портов удаленной машины с указанием номера и состояния
порта, типа используемого протокола а также названия службы, закрепленной
за этим портом. Порт характеризуется тремя возможными состояниями: "открыт",
"фильтруемый" и "нефильтруемый". Состояние "открыт" означает, что удаленная
машина прослушивает данный порт. Состояние "фильтруемый" означает, что
файрволл, пакетный фильтр или другое устройство блокирует доступ к этому
порту и Nmap не смог определить его состояние. "Нефильтруемый" означает,
что по результатам сканирования Nmap воспринял данный порт как закрытый,
при этом средства защиты не помешали Nmap определить его состояние. Это
состояние Nmap определяет в любом случае (даже если большинство сканируемых
портов хоста фильтруются).</font>
<p><font face="Times New Roman">В зависимости от указанных опций, Nmap
также может определить следующие характеристики сканируемого хоста: метод
генерации TCP ISN, имя пользователя (</font><i>username</i><font face="Times New Roman">)
владельца процесса, зарезервировавшего сканируемый порт, символьные имена,
соответствующие сканируемым IP-адресам и т.д.</font></dir>
</dir>
<b><font face="Times New Roman"><font size=+1>ОПЦИИ</font></font></b>
<dir>
<dir><font face="Times New Roman">Большинство опций могут комбинироваться
друг с другом. Одни опции предназначены для выбора определенного метода
сканирования, другие указывают на использование дополнительных возможностей
или служат для настройки различных параметров сканирования. Nmap предупреждает
пользователя о недопустимом сочетании указанных им опций. Те, кто хотят
немедленно начать работу с программой, могут пропустить этот раздел и перейти
к изучению примеров вызова Nmap в конце данного руководства. Вы можете
также запустить программу Nmap с ключом <b>'</b></font><b><font face="Courier New">-h'</font></b><font face="Times New Roman">
для получения краткой справки по всем опциям.</font>
<p><b><font face="Times New Roman">Опции выбора метода сканирования</font></b>
<dir>
<dir><font face="Courier New"><b>-sT</b></font><b><font face="Times New Roman"> </font></b>(<b>s</b>can
<b>T</b><font face="Times New Roman">CP) - использовать метод TCP connect().
Наиболее общий метод сканирования TCP-портов. Функция connect(), присутствующая
в любой ОС, позволяет создать соединение с любым портом удаленной машины.
Если указанный в качестве аргумента порт открыт и прослушивается сканируемой
машиной, то результат выполнения connect() будет успешным (т.е. соединение
будет установлено), в противном случае указанный порт является закрытым,
либо доступ к нему заблокирован средствами защиты.</font>
<p><font face="Times New Roman">Для того, чтобы использовать данный метод,
пользователь может не иметь никаких привилегий на сканирующем хосте. Этот
метод сканирования легко обнаруживается целевым (т.е. сканируемым) хостом,
поскольку его log-файл будет содержать запротоколированные многочисленные
попытки соединения и ошибки выполнения данной операции. Службы, обрабатывающие
подключения, немедленно заблокируют доступ адресу, вызвавшему эти ошибки.</font>
<p><b><font face="Courier New">-sS </font></b>(<b>s</b>can <b>S</b><font face="Times New Roman">YN)
- использовать метод TCP SYN. Этот метод часто называют "полуоткрытым"
сканированием, поскольку при этом полное TCP-соединение с портом сканируемой
машины не устанавливается. Nmap посылает SYN-пакет, как бы намереваясь
открыть настоящее соединение, и ожидает ответ. Наличие флагов SYN|ACK в
ответе указывает на то, что порт удаленной машины открыт и прослушивается.
Флаг RST в ответе означает обратное. Если Nmap принял пакет SYN|ACK, то
в ответ немедленно отправляет RST-пакет для сброса еще не установленного
соединения (реально эту операцию выполняет сама ОС). Очень немного сайтов
способны обнаружить такое сканирование. Пользователь должен иметь статус
root для формирования поддельного SYN-пакета.</font>
  <p><font face="Times New Roman">Для ускорения процесса
  опроса портов при сканировании больших
  сетей совместно с опцией </font><font face="Courier New"><b>-sS</b></font><font face="Times New Roman">
  вы можете</font><font face="Times New Roman"> использовать
  ярлык, позволяющий опросить какой-либо
  порт на всех активных объектах
  сканируемой вами сети <i><b>намного быстрее</b></i>,
  чем при использовании одной опции </font><b><font face="Courier New">-p</font></b><font face="Times New Roman">.
  Это можно сделать с помощью ярлыка </font><b><font face="Courier New">-PS
  &lt;порт&gt;</font><font face="Times New Roman">. </font></b><font face="Times New Roman">Например,
  если будет обнаружена новая уязвимость в
  sendmail, вам может потребоваться за короткое
  время обнаружить, на каких машинах sendmail
  установлен. Команда запуска Nmap будет
  выглядеть следующим образом (пример):&nbsp;</font><p style="margin-top: 0"><font face="Courier New" size="3">nmap
  -n<b> -sS </b>-p25<b> -PS25 </b>24.0.0.0/8</font>
<p><b><font face="Courier New">-sF,-sX,-sN </font></b>(<b>s</b>can <b>F</b>IN,
<b>s</b>can <b>X</b>mas, <b>s</b>can <b>N</b><font face="Times New Roman">ULL)
- "невидимое" FIN, Xmas Tree и NULL-сканирование. Эти методы используются
в случае, если SYN-сканирование по каким-либо причинам оказалось неработоспособным.
Так, некоторые файрволлы и пакетные фильтры "ожидают" поддельные SYN-пакеты
на защищенные ими порты, и программы типа Synlogger или Courtney способны
отследить SYN-сканирование.</font>
<p><font face="Times New Roman">Идея заключается в следующем. В FIN-сканировании
в качестве запроса используется FIN-пакет. В Xmas Tree используется пакет
с набором флагов FIN|URG|PSH, а NULL-сканирование использует пакет без
флагов. Согласно рекомендации RFC 973 п. 64, ОС сканируемого хоста должна
ответить на такой пакет, прибывший на закрытый порт, пакетом RST, в то
время как открытый порт должен игнорировать эти пакеты.</font>
<p><font face="Times New Roman">Разработчики Microsoft Windows, как обычно,
решили полностью игнорировать все общепринятые стандарты и пойти своим
путем. Поэтому любая ОС семейства Windows не посылает в ответ RST-пакет,
и данные методы не будут работать с этими ОС. Однако во всем есть свои
плюсы, и в Nmap этот признак является основным для различения операционных
систем, обладающих таким свойством.</font>
<p><font face="Times New Roman">Если в результате FIN-сканирования вы получили
список открытых портов, то это не Windows. Если же все эти методы выдали
результат, что все порты закрыты, а SYN-сканирование обнаружило открытые
порты, то вы скорей всего имеете дело с ОС Windows. К сожалению, Windows
не единственная ОС, обладающая этим недостатком. К таким ОС относятся также
Cisco, BSDI, IRIX, HP/UX и MVS. Все эти ОС не отправляют RST-пакеты.</font>
<p><b><font face="Courier New">-sP </font></b>(<b>s</b>can <b>P</b><font face="Times New Roman">ing)
- ping-"сканирование". Иногда вам необходимо лишь узнать адреса активных
хостов в сканируемой сети. Nmap может сделать это, послав ICMP-сообщение
"запрос эха" на каждый IP-адрес, указанный вами. Хост, отправивший ответ
на эхо, является активным.</font>
<p><font face="Times New Roman">Некоторые сайты (например microsoft.com)
блокируют эхо-пакеты. По этой причине Nmap также посылает TCP ACK-пакет
на 80-й порт сканируемого хоста (по умолчанию). Если в ответ вы получили
RST-пакет, хост активен. Третий метод использует SYN-пакет и ожидает в
ответ RST либо SYN|ACK. Для пользователей, не обладающих статусом root,
используется метод connect().</font>
<p><font face="Times New Roman">Для root-пользователей Nmap по умолчанию
использует параллельно оба метода - ICMP и ACK. Вы можете изменить это,
используя опцию <b>'</b></font><b><font face="Courier New">-P'</font></b><font face="Times New Roman">,
описанную ниже. Заметим, что ping-сканирование по умолчанию выполняется
в любом случае и только активные хосты подвергаются сканированию. Используйте
эту опцию только в случае, если вы хотите выполнить только ping-опрос,
не производя сканирования портов.</font>
<p><b><font face="Courier New">-sU </font></b>(<b>s</b>can <b>U</b><font face="Times New Roman">DP)
- сканировать UDP-порты. Этот метод используется для определения, какие
UDP-порты (RFC 768) на сканируемом хосте являются открытыми. На каждый
порт сканируемой машины отправляется UDP-пакет без данных. Если в ответ
было получено ICMP-сообщение "порт недоступен", это означает, что порт
закрыт. В противном случае предполагается, что сканируемый порт открыт.</font>
<p><font face="Times New Roman">Некоторые считают сканирование UDP-портов
бесполезным занятием. Мы в этом случае напоминаем о известной "дыре" в
демоне </font><font face="Courier New">rpcbind</font><font face="Times New Roman">
ОС Solaris. Он может быть обнаружен на любом из недокументированных UDP-портов
с номером, больше 32770. Если вы обнаружите его, то будет уже не важно,
блокируется ли 111-й порт файрволлом или нет.</font>
<p><font face="Times New Roman">К сожалению, сканирование UDP-портов проходит
очень медленно, поскольку практически все ОС следуют рекомендации RFC 1812
(раздел 4.3.2.8) по ограничению скорости генерирования ICMP-сообщений "порт
недоступен". Например, ядро Linux (каталог net/ipv4/icmp.h) ограничивает
генерирование таких сообщений до 80 за 4 секунды с простоем 0,25 секунды,
если это ограничение было превышено. У ОС Solaris еще более жесткое ограничение
(2 сообщения в секунду), и поэтому сканирование Solaris проходит еще более
медленно.</font>
<p><font face="Times New Roman">Nmap определяет параметры этого ограничения,
и соответственно уменьшает количество генерируемых запросов, предотвращая
тем самым затопление сети ненужными пакетами, которые игнорируются целевой
машиной. Как обычно, Microsoft снова все проигнорировала, и не использует
в своих ОС никаких ограничений. Поэтому вы очень быстро можете просканировать
все 65535 UDP-портов хоста, работающего под управлением ОС Windows.</font>
<p><b><font face="Courier">-sO</font><font face="Times New Roman"> </font></b><font face="Times New Roman">(<b>s</b>can
<b>O</b>pen protocol) - сканирование протоколов IP.
Данный метод используется для определения
IP-протоколов, поддерживаемых сканируемым
хостом. Метод заключается в передаче хосту
IP-пакетов без какого-либо заголовка для
каждого протокола сканируемого хоста. Если
получено сообщение &quot;Протокол недоступен&quot;,
то данный протокол хостом не используется.
В противном случае Nmap предполагает, что
протокол поддерживается хостом.</font><p><font face="Times New Roman">Некоторые
ОС (AIX, HP-UX, Digital UNIX) и файрволлы могут
блокировать передачу сообщений &quot;Протокол
недоступен&quot;. По этой причине все
сканируемые протоколы будут &quot;открыты&quot;
(т.е. поддерживаются).</font><p><font face="Times New Roman">Поскольку
описанная техника схожа с методом
сканирования UDP-портов, ограничение
скорости генерации ICMP-сообщений также
будет иметь место.&nbsp; Однако поле &quot;тип
протокола&quot; IP-заголовка состоит всего
лишь из 8 бит, поэтому 256 протоколов будут
отсканированы за приемлемое время.</font>
<p><b><font face="Courier New">-sA</font></b> (<b>s</b>can <b>A</b><font face="Times New Roman">CK)
- использовать ACK-сканирование. Этот дополнительный метод используется
для определения набора правил (ruleset) файрволла. В частности, он помогает
определит, защищен ли сканируемый хост файрволлом или просто пакетным фильтром,
блокирующим входящие SYN-пакеты.</font>
<p><font face="Times New Roman">В этом методе на сканируемый порт хоста
отправляется ACK-пакет (со случайными значениями полей </font><i>acknowledgement
number</i><font face="Times New Roman"> и </font><i>sequence number</i><font face="Times New Roman">).
Если в ответ пришел RST-пакет, порт классифицируется как "нефильтруемый".
Если ответа не последовало (или пришло ICMP-сообщение о недоступности порта),
порт классифицируется как "фильтруемый".</font>
<p><font face="Times New Roman">Заметим, что Nmap не выдает "нефильтруемые"
порты в результатах, поэтому если вы не обнаружите ни одного открытого
порта при использовании этого типа сканирования, это будет означать, что
все порты просканированы и являются нефильтруемыми. Обращаем ваше внимание,
что этот метод никогда не покажет состояние порта "открыт" в результатах
сканирования.</font>
<p><b><font face="Courier New">-sW</font></b> (<b>s</b>can <b>W</b><font face="Times New Roman">indow)
- использовать метод TCP Window. Этот метод похож на ACK-сканирование,
за исключением того, что иногда с его помощью можно определять открытые
порты точно так же, как и фильтруемые/нефильтруемые. Это можно сделать,
проверив значение поля Initial Window TCP-пакета, возвращаемого хостом
в ответ на посланный ему запрос, ввиду наличия определенных особенностей
обработки данного поля у некоторых ОС.</font>
<p><font face="Times New Roman">Список уязвимых операционных систем включает
в себя по крайней мере несколько версий AIX, Amiga, BeOS, BSDI, Cray, Tru64
UNIX, DG/UX, OpenVMS, Digital UNIX, FreeBSD, HP-UX, OS/2, IRIX, MacOS,
NetBSD, OpenBSD, OpenStep, QNX, Rhapsody, SunOS 4.X, Ultrix, VAX и VxWorks.
Для более подробной информации смотрите архив nmap-hackers.</font>
<p><b><font face="Courier New">-sR </font></b>(<b>s</b>can <b>R</b><font face="Times New Roman">PC)
- использовать RPC-сканирование. Этот метод используется совместно с другими
методами сканирования и позволяет определить программу, которая обслуживает
RPC-порт, и номер ее версии. Для этого все открытые TCP/UDP-порты хоста
затопляются NULL-командами оболочки SunRPC, после чего определяются RPC-порты
и закрепленные за ними программы. Таким образом, вы легко получаете информацию,
которую могли бы получить с помощью команды '</font><font face="Courier New">rpcinfo
-p'</font><font face="Times New Roman">, даже если portmapper сканируемого
хоста закрыт файрволлом или TCP-wrapper'ом.</font>
<p><b><font face="Courier New">-sL </font></b><font face="Times New Roman">(<b>s</b>can
<b>L</b>ist) - получить список сканируемых
адресов. Эта опция позволяет вам получить
список адресов хостов, которые <b>БУДУТ</b>
просканированы Nmap, до начала процесса
сканирования. По умолчанию определяются
имена хостов, однако это можно запретить,
используя опцию </font><b><font face="Courier New">-n</font></b><font face="Times New Roman">.
Опция может использоваться в случае, когда
вам необходимо определить имена большого
количества хостов по их адресам и т.д.</font>
<p><b><font face="Courier New">-b &lt;ftp_relay хост> </font></b>(<b>b</b><font face="Times New Roman">ounche
scan) - использовать атаку "Прорыв через FTP". Интересной "возможностью"
протокола FTP (RFC 959) является поддержка "доверенных" (proxy) ftp-соединений.
Другими словами, с доверенного хоста source.com можно соединиться с ftp-сервером
target.com и отправить файл, находящийся на нем, на любой адрес Internet!
Заметим, что данная возможность известна с 1985 года (когда был написан
этот RFC). Nmap использует эту "дыру" для сканирования портов с "доверенного"
ftp-сервера.</font>
<p><font face="Times New Roman">Итак, вы можете подключиться к ftp-серверу
"над" файрволлом и затем просканировать заблокированные им порты (например
139-й). Если ftp-сервер позволяет читать и записывать данные в какой-либо
каталог (например /incoming), вы также можете отправить любые данные на
эти порты. Аргумент, указываемый после <b>'</b></font><b><font face="Courier New">-b'</font></b><font face="Times New Roman">,
представляет собой URL сервера ftp, используемого в качестве "доверенного".
Формат URL следующий: </font><b><font face="Courier New">имя_пользователя:пароль@сервер:порт</font></b><font face="Times New Roman">.
Адрес сервера нужно указать обязательно, остальное можно не указывать.</font>
<p><b><font face="Times New Roman">Опции настройки и выбора дополнительных
возможностей</font></b>
<p><font face="Times New Roman">Эти опции не обязательные (т.е. возможна
нормальная работа Nmap и без их указания), однако все они являются весьма
полезными.</font>
<p><b><font face="Courier New">-P0 </font></b>(<b>P</b>ing <b>0</b><font face="Times New Roman">)
- не производить ping-опрос хостов перед их непосредственным сканированием.
Эта опция позволяет просканировать сети, блокирующие обработку ICMP-эха
с помощью файрволлов. Примером такой сети является microsoft.com, и вы
всегда должны использовать опцию <b>'</b></font><b><font face="Courier New">-P0'</font></b><font face="Times New Roman">или<b>'</b></font><b><font face="Courier New">-PT80'</font></b><font face="Times New Roman">(см.
ниже), когда сканируете такую сеть.</font>
<p><b><font face="Courier New">-PT </font></b>(<b>P</b>ing <b>T</b><font face="Times New Roman">CP)
- использовать TCP "ping". Вместо посылки запроса ICMP-эха, Nmap отправляет
TCP ACK-пакет на сканируемый хост и ожидаем ответ. Если хост активен, то
в ответ должен придти RST-пакет. Для не-root пользователей используется
функция connect(). Эта опция позволяет вам определить состояние сканируемого
хоста, даже если обработка ICMP-эха запрещена файрволлом. Для указания
номера порта сканируемого сервера, на который будет отправляться ACK-пакет,
используется опция <b>'</b></font><b><font face="Courier New">-PT &lt;номер_порта>'</font></b><font face="Times New Roman">.
По умолчанию используется 80-й порт, поскольку он практически никогда не
фильтруется.</font>
<p><b><font face="Courier New">-PS </font></b>(<b>P</b>ing <b>S</b><font face="Times New Roman">YN)
- опция, также используемая для ping-опроса. При этом вместо ACK-пакета
TCP "ping" используется SYN-пакет. Активные хосты посылают в ответ RST-пакеты
(реже - SYN|ACK).</font>
<p><b><font face="Courier New">-PI </font></b><font face="Times New Roman">(Ping
ICMP) - эта опция использует в качестве ping-запроса нормальный ping-пакет
(запрос ICMP-эха). Опция применяется для поиска активных хостов а также
адресов сетей с возможностью широковещания. Такие сети пересылают прибывший
ICMP-пакет всем своим объектам. Как правило, такие сети представляют собой
"живую мишень" для хакера.</font>
<p><b><font face="Courier New">-PB </font></b>(<b>P</b>ing <b>B</b><font face="Times New Roman">oth)
- режим ping-опроса по умолчанию. Использует одновременно запросы типа
ACK и ICMP.</font>
<p><b><font face="Courier New">-O </font></b>(<b>O</b>perating syste<font face="Times New Roman">m
detection) - эта опция позволяет определить операционную систему сканируемого
хоста с помощью метода отпечатков стека TCP/IP. Другими словами, Nmap активизирует
мощный алгоритм, функционирующий на основе анализа свойств сетевого программного
обеспечения установленной на нем ОС. В результате сканирования получается
формализованный "отпечаток", состоящий из стандартных тестовых запросов
и "ответов" хоста на них. Затем полученный отпечаток сравнивается с имеющейся
базой стандартных ответов известных ОС, хранящейся в файле nmap-os-fingerprinting,
и на основании этого принимается решение о типе и версии ОС сканируемого
хоста.</font>
<p><font face="Times New Roman">Этот метод требует наличия хотя бы одного
закрытого и одного открытого порта на целевом хосте. Если вы обнаружите
машину, у которой это условие выполняется, но Nmap не смог определить версию
ОС - вышлите нам адрес этой машины. Если же, по каким-либо причинам выслать
адрес не представляется возможным, запустите Nmap с опцией <b>'</b></font><b><font face="Courier New">-d'</font></b><font face="Times New Roman">
и вышлите полученный отпечаток.</font>
<p><b><font face="Courier New">-I </font></b>(<b>I</b><font face="Times New Roman">dent
scan) - использовать reverse-ident сканирование. Протокол Ident (RFC 1413)
позволяет вскрыть имя пользователя (</font><i>username</i><font face="Times New Roman">)
процесса, использующего TCP, даже если этот процесс не инициализировал
соединение. Так, например, вы можете подключиться к порту http и затем
использовать identd для поиска на сервере пользователя root. Это может
быть сделано только при установлении "полного" TCP-соединения с портом
сканируемой машины (т.е. необходимо использовать опцию <b>'</b></font><b><font face="Courier New">-sT'</font></b><font face="Times New Roman">).
Nmap опрашивает identd сканируемого хоста параллельно с каждым открытым
портом. Естественно, этот метод не будет работать, если на целевом хосте
не запущен identd.</font>
<p><b><font face="Courier New">-f </font></b>(use <b>f</b><font face="Times New Roman">ragmentation)
- эта опция используется совместно с SYN, FIN, Xmas или NULL-сканировании
и указывает на необходимость использования IP-фрагментации с малым размером
фрагментов. Идея заключается в том, чтобы разбить TCP-заголовок пакета
на несколько фрагментов (обычно два) на стороне источника. Сканируемый
хост "собирает" эти IP-фрагменты в один TCP-пакет.</font>
<p><font face="Times New Roman">Это значительно усложняет фильтрацию пакетов,
работу систем обнаружения и других подобных средств защиты, и позволяет
Nmap скрыть свои действия. Будьте осторожны, используя эту опцию! Некоторые
программы "зависают" при попытке собрать такие маленькие фрагменты. Так,
например, весьма неплохой "сниффер" завис сразу же при получении первого
36-байтного фрагмента. А следом за ним пришел 24-байтный фрагмент.</font>
<p><b><font face="Courier New">-v </font></b>(<b>v</b><font face="Times New Roman">erbose
output) - использовать режим "подробного отчета". Эту опцию рекомендуется
использовать в любых случаях, поскольку при этом Nmap подробно сообщает
о ходе выполнения текущей операции. Для получения лучшего эффекта можно
указать ее дважды. Ну а если вы укажете еще опцию <b>'</b></font><b><font face="Courier New">-d'</font></b><font face="Times New Roman">,
то от скроллинга экрана у вас может закружиться голова.</font>
<p><b><font face="Courier New">-h </font></b>(show <b>h</b><font face="Times New Roman">elp)
- печатает справку по использованию Nmap с указанием опций и краткого их
описания, не запуская саму программу.</font>
<p><b><font face="Courier New">-oN &lt;имя_файла> </font></b>(<b>o</b>utput
<b>N</b><font face="Times New Roman">ormal) - записывает результаты сканирования
в указанный файл в удобной для пользователя форме.</font>
<p><b><font face="Courier New">-oM &lt;имя_файла> </font></b>(<b>o</b>utput
<b>M</b><font face="Times New Roman">achine) - записывает результат сканирования
в указанный файл в машинном виде для дальнейшего анализа пакетов, пришедших
от сканируемого хоста. Если вам необходимо использовать для записи интерфейс
StdOut, укажите в качестве имени файла знак '</font><b><font face="Courier New">-'</font></b><font face="Times New Roman">.
В этом случае сообщения об ошибках можно просмотреть с помощью функции
StdErr.</font>
<p><b><font face="Courier New">-oS &lt;имя_файла> </font></b>(<b>o</b>utput
<b>S</b><font face="Times New Roman">cript kiddie) - Эту возможность мы
предусмотрели для любителей языка </font><font face="Courier New">s|&lt;ipT
kiDdi3</font>.
<p><b><font face="Courier New">--resume &lt;имя_файла> </font></b><font face="Times New Roman">-
если вы прервали сканирование сети нажатием комбинации &lt;Ctrl C>, то
вы можете продолжить его, используя эту опцию, если результаты сканирования
записывались в лог-файл с помощью опций <b>'</b></font><b><font face="Courier New">-oM'</font></b><font face="Times New Roman">
или <b>'</b></font><b><font face="Courier New">-oN'</font></b><font face="Times New Roman">.
В этом случае запустите Nmap с указанием этой опции и имени файла, в который
производилась запись предыдущего сеанса. При этом никаких других опций
указывать не нужно, поскольку при возобновлении сканирования будут использоваться
опции, указанные в предыдущем сеансе. Nmap продолжит сканирование с адреса,
следующего за последним "завершенным".</font>
<p><b><font face="Courier New">-iL &lt;имя_файла> </font></b>(<b>i</b>nput
<b>L</b><font face="Times New Roman">ist) - считывает описание целевых
хостов из текстового файла. Файл должен содержать список имен хостов или
IP-адресов, разделенных пробелами, знаками табуляции или комбинацией &lt;CR>&lt;LF>
(каждый хост - с новой строки). Если вы хотите использовать StdIn в качестве
источника информации о хостах, укажите вместо имени файла символ <b>'</b></font><b><font face="Courier New">-'</font></b><font face="Times New Roman">.
Более подробная информация о форматах выражений приведены в разделе "Способы
задания целевого хоста".</font>
<p><b><font face="Courier New">-iR </font></b>(<b>i</b>nput <b>R</b><font face="Times New Roman">andom)
- если вы укажете эту опцию, Nmap будет сканировать случайно выбранные
им хосты, адреса которых получены с помощью генератора случайных величин.
Этот процесс будет длиться, пока вы его не остановите. Функция может пригодиться
для статистического исследования Internet.</font>
<p><b><font face="Courier New">-p &lt;диапазон(ы)_портов> </font></b>(<b>p</b><font face="Times New Roman">orts)
- эта опция указывает Nmap, какие порты необходимо просканировать. Например,
'</font><b><font face="Courier New">-p23'</font></b><font face="Times New Roman">
означает сканирование 23 порта на целевой машины. Если указано выражение
типа <b>'</b></font><b><font face="Courier New">-p 20-30,139,60000-'</font></b><font face="Times New Roman">,
Nmap будет сканировать порты с номерами с 20 по 30 включительно, 139 и
от 60000 и выше (до 65535). По умолчанию Nmap сканирует все порты в диапазоне
1-1024, поскольку все они перечислены в файле services.</font>
<p><b><font face="Courier New">-F </font></b>(<b>F</b><font face="Times New Roman">ast
scan) - быстрое сканирование. Указывает Nmap на необходимость сканирования
портов только тех служб, которые перечислены в файле services. Сканирование
проходит гораздо быстрее, чем если бы Nmap сканировал все 65535 портов.</font>
<p><b><font face="Courier New">-D &lt;ложный_хост1,[ложный_хост2],[,ME],...></font></b>
(use <b>D</b><font face="Times New Roman">ecoy hosts). - В этом режиме
Nmap "создает" ложные хосты, адреса которых задаются произвольно и указываются
в качестве аргументов. При этом на стороне сканируемого хоста создается
видимость, что производится одновременное сканирование с различных хостов
(обладающих разными IP-адресами), что очень затрудняет обнаружение вашего
реального IP-адреса.</font>
<p><font face="Times New Roman">Адреса разделяются запятой. Вы также можете
указать свой IP-адрес (аргумент <b>'</b></font><b><font face="Courier New">ME'</font></b><font face="Times New Roman">)
в качестве одного из хостов. Однако если вы поместили аргумент <b>'</b></font><b><font face="Courier New">ME'</font></b><font face="Times New Roman">
на шестой позиции и выше, некоторые скан-детекторы (например Solar Designer's
Excellent Scanlogd) покажут ваш IP-адрес как наиболее предполагаемый. Если
вы явно не указали аргумент <b>'</b></font><b><font face="Courier New">ME'</font></b><font face="Times New Roman">,
Nmap поместит вас на случайную позицию. Также вы можете указать имена хостов
вместо их IP-адресов. Заметим, что хосты, указанные вами в качестве ложных,
должны реально существовать и функционировать, в противном случае вы можете
"затопить" сканируемый хост SYN-пакетами. Это также может способствовать
обнаружению вашего хоста, потому что если ложные хосты не функционируют,
то единственным работающим хостом окажется ваш.</font>
<p><font face="Times New Roman">Стоит заметить, что некоторые скан-детекторы
блокируют доступ хосту, осуществившему попытку сканирования. Поэтому ложный
хост может потерять соединение со сканируемым хостом. Эта ситуация может
возникнуть даже в том случае, если вы указали в качестве ложного хоста
адрес шлюза или 'localhost'. Поэтому аккуратно используйте эту опцию.</font>
<p><font face="Times New Roman">Ложные хосты могут использоваться с любым
методом сканирования, а также при определении операционной системы. Если
вы указали много ложных хостов, это замедлит процесс сканирования и сделает
его менее точным. Некоторые провайдеры могут отфильтровывать ваши пакеты
(но еще больше их не отфильтруют), и в этом случае использование ложных
хостов не даст вам ожидаемого результата.</font>
<p><b><font face="Courier New">-S &lt;IP-адрес> </font></b>(set <b>S</b><font face="Times New Roman">ource)
- Если Nmap не смог автоматически определить IP-адрес вашего хоста (о чем
вы получили соответствующее сообщение), вам необходимо самостоятельно указать
IP-адрес, используя его в качестве аргумента данной опции (т.е. адрес интерфейса,
который вы хотите использовать). Другое применение данной опции - для создания
видимости сканирования целевого хоста кем-то другим. В этом случае вы не
сможете получить результат, однако на стороне сканируемого хоста создается
видимость сканирования с указанного вами адреса. Для этого совместно с
<b>'</b></font><b><font face="Courier New">-S'</font></b><font face="Times New Roman">необходимо
использовать опцию <b>'</b></font><b><font face="Courier New">-e'</font></b>.
<p><b><font face="Courier New">-e &lt;интерфейс> </font></b>(int<b>e</b><font face="Times New Roman">rface)
- указывает Nmap, какой интерфейс будет использоваться для приема/передачи
пакетов. Имя интерфейса указывается в качестве аргумента опции. Nmap обычно
сам определяет интерфейс, однако выдаст вам соответствующее сообщение,
если по каким-либо причинам он не смог этого сделать.</font>
<p><b><font face="Courier New">-g &lt;номер_порта></font></b><font face="Times New Roman">
- указывает номер порта на вашем компьютере, который будет использоваться
Nmap для осуществления сканирования. Многие файрволлы и пакетные фильтры
позволяют проходить пакетам DNS (порт 53) и FTP-DATA (порт 20) к защищаемому
ими хосту и установить соединение. Этот момент является большой "дырой"
в безопасности файрволлов, поэтому атакующему ничего не стоит отправлять
нужные ему пакеты через 53-й или 20-й порт.</font>
<p><font face="Times New Roman">Для сканирования UDP-портов Nmap пробует
сначала 53-й порт, а затем 20-й. Для TCP-портов - наоборот. Заметим, что
это влияет на поле "порт источника" в запросе и поэтому не всегда работает.
Например, вы не сможете определить характер изменения ISN, всвязи с чем
Nmap самостоятельно сменит номер порта для этой цели, даже если вы используете
опцию <b>'</b></font><b><font face="Courier New">-g'</font></b>.
<p><b><font face="Courier New">-r </font></b>(<b>r</b><font face="Times New Roman">andomize
off) - для обеспечения скрытности очередной номер сканируемого хоста Nmap
выбирает случайным образом. Эта опция указывает на то, что необходимо отключить
случайный выбор портов и производить их последовательное сканирование.</font>
<p><b><font face="Courier New">--randomize_hosts</font></b><font face="Times New Roman">
- указывает Nmap на необходимость случайной перестановки каждой группы
из 2048 хостов перед непосредственным их сканированием. Эта опция делает
сканирование менее заметным для различных систем сетевого мониторинга,
особенно если вы используете ее совместно с опцией настройки времени, устанавливающей
более медленное сканирование.</font>
<p><b><font face="Courier New">-M &lt;максимум_сокетов> </font></b>(<b>M</b><font face="Times New Roman">ax
sockets) - устанавливает максимальное количество сокетов, используемых
параллельно в методе TCP connect() сканирования. Установка меньшего значения
немного замедляет процесс сканирования, но предотвращает "завал" сканируемого
хоста. Для последней цели лучше всего использовать опцию <b>'</b></font><b><font face="Courier New">-sS'</font></b><font face="Times New Roman">,
так как SYN-сканирование гораздо легче "переносится" операционными системами.</font>
<p><b><font face="Times New Roman">Опции настройки временных параметров</font></b>
<p><font face="Times New Roman">Обычно Nmap автоматически настраивает временные
параметры в соответствии с характеристиками сканируемой сети. Настройки
осуществляются, во-первых, для проведения максимально быстрого сканирования,
и во-вторых, для уменьшения вероятности появления ошибок. Если вас не устраивает
автоматическая настройка временных параметров, вы можете настроить их самостоятельно,
используя эти опции.</font>
<p><b><font face="Courier New">-T &lt;Paranoid|Sneaky|Polite|Normal|Aggressive|Insane></font></b>
(<b>T</b><font face="Times New Roman">iming options) - эта опция устанавливает
временной режим сканирования. Требуемый режим указывается в качестве аргумента.
Режим </font><b><font face="Courier New">Paranoid</font></b><font face="Times New Roman">
используется в случае, когда очень велика вероятность использования скан-детекторов.
В этом режиме сканирование проходит очень медленно. Параллельне сканирование
не используется. Вместо этого Nmap проводит сканирование последовательно,
с интервалом по меньшей мере 5 минут между посылкой пакетов.</font>
<p><font face="Times New Roman">Режим </font><b><font face="Courier New">Sneaky</font></b><font face="Times New Roman">
похож на режим Paranoid. Разница заключается в том, что интервал между
посылкой двух пакетов составляет 15 секунд.</font>
<p><font face="Times New Roman">Режим </font><b><font face="Courier New">Polite</font></b><font face="Times New Roman">
используется в случае, когда необходимо минимизировать нагрузку на сеть
и уменьшить вероятность "завала" сканируемого хоста. В этом режиме тесты
проходят последовательно с интервалом минимум 0,4 секунды.</font>
<p><font face="Times New Roman">Режим </font><b><font face="Courier New">Normal</font></b><font face="Times New Roman">
используется Nmap по умолчанию. В этом режиме сканирование производится
с максимально возможной скоростью, и по возможности без перегрузки сети
и возникновения ошибок.</font>
<p><font face="Times New Roman">В режиме </font><b><font face="Courier New">Aggressive</font></b><font face="Times New Roman">
устанавливается ограничение на сканирование одного хоста, равное 5 минутам,
и, кроме того, время ожидания ответа на запрос не превышает 1,25 секунды.</font>
<p><font face="Times New Roman">Режим </font><b><font face="Courier New">Insane</font></b><font face="Times New Roman">
применяется только при сканировании очень быстрых сетей. Время сканирования
одного хоста составляет 75 секунд, а ожидание ответа на запрос - 0,3 секунды.</font>
<p><font face="Times New Roman">Каждому режиму присвоен соответствующий
номер, и вы можете указать его вместо полного названия режима. Так, опция
<b>'</b></font><b><font face="Courier New">-T0'</font></b><font face="Times New Roman">
означает режим </font><b><font face="Courier New">Paranoid</font></b><font face="Times New Roman">,
а <b>'</b></font><b><font face="Courier New">-T5'</font></b> - <b><font face="Courier New">Insane</font></b><font face="Times New Roman">.
Нумерация соответствует порядку, в котором они были перечислены выше. Заметим,
что опция <b>'</b></font><b><font face="Courier New">-T'</font></b><font face="Times New Roman">
осуществляет настройку Nmap на высоком уровне, и не должна использоваться
с опциями, приведенными ниже (они обеспечивают низкоуровневую настройку).</font>
<p><b><font face="Courier New">--host_timeout &lt;миллисекунд></font></b><font face="Times New Roman">
- устанавливает время, отводимое Nmap на полное сканирование одного хоста,
прежде чем он перейдет к очередному IP-адресу. По умолчанию этот параметр
отсутствует, т.е. Nmap не переходит к очередному адресу до окончания сканирования
текущего.</font>
<p><b><font face="Courier New">--max_rtt_timeout &lt;миллисекунд></font></b>
 (maximal <b>r</b>ound-<b>t</b>rip <b>t</b>ime <b>timeout</b><font face="Times New Roman">)
- устанавливает верхнюю границу временного интервала, в течение которого
Nmap ожидает ответ на посланный запрос, прежде чем повторить запрос либо
послать новый. По умолчанию это значение установлено равным 5000 миллисекунд.</font>
<p><b><font face="Courier New">--min_rtt_timeout &lt;миллисекунд></font></b><font face="Times New Roman">
- Если сканируемый хост немедленно отвечает на посланный запрос, Nmap сразу
же передает следующий, сэкономив тем самым очень много времени. Это ускоряет
сканирование, но может привести к потере пакетов с ответами, пришедшими
несколько позже, чем обычно. Эта опция устанавливает нижнюю границу времени
ожидания ответа, т.е. Nmap в любом случае будет ждать в течении указанного
вами времени не зависимо от того, пришел ответ или нет.</font>
<p><b><font face="Courier New">--initial_rtt_timeout &lt;миллисекунд></font></b><font face="Times New Roman">
- устанавливает время, отводимое на начальный тест. Эта опция используется
в основном для сканирования хостов, защищенных файрволлом, совместно с
опцией <b>'</b></font><b><font face="Courier New">-P0'</font></b><font face="Times New Roman">.
Обычно Nmap автоматически выбирает оптимальное значение этого параметра.
Значение по умолчанию составляет 6000 миллисекунд.</font>
<p><b><font face="Courier New">--max_parallelism &lt;количество></font></b><font face="Times New Roman">
- устанавливает максимальное количество параллельных процессов сканирования,
используемых Nmap. Установка этого параметра равным 1 означает, что Nmap
никогда не будет сканировать более одного порта в один момент времени.</font>
<p><b><font face="Courier New">--scan_delay &lt;миллисекунд></font></b><font face="Times New Roman">
- устанавливает минимальное время задержки между тестами. Эта опция может
использоваться для снижения нагрузки на сеть и уменьшения вероятности обнаружения
сканирования.</font></dir>
</dir>
</dir>
</dir>
<b><font face="Times New Roman"><font size=+1>СПОСОБЫ ЗАДАНИЯ ЦЕЛЕВОГО
ХОСТА</font></font></b>
<dir>
<dir>
<dir>
<dir><font face="Times New Roman">Все, что не является опцией или ее аргументом,
Nmap воспринимает как адрес или имя целевого хоста (т.е. хоста, подвергаемого
сканированию). Простейший способ задать сканируемый хост - указать его
имя или адрес в командной строке после указания опций и аргументов. Если
вы хотите просканировать подсеть IP-адресов, вам необходимо указать параметр
<b>'</b></font><b><font face="Courier New">/&lt;mask>'</font></b><font face="Times New Roman">
("маска") после имени или IP-адреса сканируемого хоста. Маска может принимать
следующие значения:</font>
<dir>
<dir>
<dir><font face="Times New Roman">'/0' - сканировать весь Интернет;</font>
<p><font face="Times New Roman">'/16' - сканировать адреса класса B;</font>
<p><font face="Times New Roman">'/24' - сканировать адреса класса С;</font>
<p><font face="Times New Roman">'/32' - сканировать только указанный хост.</font></dir>
</dir>
</dir>
<font face="Times New Roman">Nmap позволяет также гибко указать целевые
IP-адреса, используя списки и диапазоны для каждого их элемента. Например,
необходимо просканировать подсеть класса B с адресом 128.210.*.*. Задать
эту сеть можно любым из следующих способов:</font>
<dir>
<dir>
<dir>128.210.*.*
<p>128.210.0-255.0-255
<p>128.210.1-50,51-255.1,2,3,4,5-255
<p>128.210.0.0/16</dir>
</dir>
</dir>
<font face="Times New Roman">Все эти строки эквивалентны. Заметим, что
если вы используете "звездочку" ('*'), то в большинстве оболочек вам понадобится
отделить ее обратной "косой чертой" либо апострофами. Приведем еще один
пример. Если вы указали в качестве целевого IP-адреса строку '*.*.5.6-7',
Nmap отсканирует все IP-адреса, оканчивающиеся на 5.6 либо 5.7. Более подробно
примеры вызова программы Nmap приведены ниже.</font></dir>
</dir>
</dir>
</dir>
<b><font face="Times New Roman"><font size=+1>ПРИМЕРЫ</font></font></b>
<dir>
<dir>
<dir>
<dir><font face="Times New Roman">Приведем некоторые примеры использования
Nmap и соответствующие способы запуска программы с указанием параметров
в командной строке.</font>
<p><b><font face="Courier New">nmap -v target.example.com</font></b>
<p><font face="Times New Roman">Сканировать все зарезервированные TCP-порты
на хосте target.example.com. Опция <b>'</b></font><b><font face="Courier New">-v'</font></b><font face="Times New Roman">
означает включение режима подробного отчета о ходе процесса сканирования.</font>
<p><b><font face="Courier New">nmap -sS -O target.example.com/24</font></b>
<p><font face="Times New Roman">Запускает SYN-сканирование всех 255 машин
с адресами класса C, одной из которых является target.example.com. Кроме
того, осуществляется определение ОС каждого из сканируемых хостов. Для
этого вам необходим статус root.</font>
<p><b><font face="Courier New">nmap -sX -p 22,53,110,143,4564 128.210.*.1-127</font></b>
<p><font face="Times New Roman">Осуществляет Xmas-сканирование первой половины
адресов (0-127) каждой из 255 подсетей класса B адресного пространства
128.210.*.*. На этих хостах тестируется присутствие sshd (22 порт), DNS
(53), pop3d (110), imapd (143) и состояние порта 4564. Обращаем внимание,
что Xmas-сканирование не будет работать с ОС Windows, CISCO, IRIX, HP/UX
и BSDI.</font>
<p><b><font face="Courier New">nmap -v --randomize_hosts -p80 *.*.2.3-5</font></b>
<p><font face="Times New Roman">Nmap будет искать все машины, IP-адрес
которых оканчивается на .2.3, .2.4 и .2.5. Если ваш статус root, вы также
можете просканировать порты обнаруженных хостов, указав опцию <b>'</b></font><b><font face="Courier New">-sS'</font></b><font face="Times New Roman">.
Вы найдете много интересных машин, адреса которых начинаются на 127. Поэтому
мы рекомендуем вместо первой звездочки указать '127-222'. Попробуйте обязательно!</font>
<p><b><font face="Courier New">host -l company.com |cut '-d' -f 4| ./nmap
-v -iL</font></b>
<p><font face="Times New Roman">Просканировать серверы DNS зоны и найти
хосты в домене company.com, передав затем в Nmap их адреса. Так выглядит
команда для GNU/Linux. Для других ОС она будет выглядеть несколько иначе.</font></dir>
</dir>
</dir>
</dir>
<b><font face="Times New Roman"><font size=+1>ВОЗМОЖНЫЕ ОШИБКИ</font></font></b>
<dir>
<dir>
<dir>
<dir><font face="Times New Roman">Если вы обнаружили какие-либо симптомы,
говорящие о неверной работе программы, или нашли место в коде, приводящее
к такому эффекту - немедленно отправьте нам эту информацию. Не забывайте
также отправлять нам отпечатки ОС, чтобы пополнять базу данных Nmap. Программа
выдаст вам соответствующее сообщение и URL, где она обнаружила новый отпечаток.</font></dir>
</dir>
</dir>
</dir>
<b><font face="Times New Roman"><font size=+1>АВТОРЫ</font></font></b>
<dir>
<dir>
<dir>
<dir><font face="Times New Roman">Базовая версия:</font>
<dir>&nbsp;
<dir>
<dir>
<dir>Nmap 2.54BETA3 release by Fyodor
<p><a href="mailto:fyodor@dhp.com">fyodor@dhp.com</a>
<p><a href="mailto:fyodor@insecure.org">fyodor@insecure.org</a>
<p><a href="http://www.insecure.org">http://www.insecure.org</a></dir>
</dir>
</dir>
</dir>
<font face="Times New Roman">Русская версия:</font>
<dir>&nbsp;
<dir>
<dir>
<dir><font face="Times New Roman">RuNmap 2.53, Алексей Волков</font>
<p><a href="mailto:topcat@nm.ru">topcat@nm.ru</a>
<p><a href="mailto:topcat@nm.ru">topcat@nm.ru</a>
<p><a href="http://insecure.nm.ru">http://insecure.nm.ru</a></dir>
</dir>
</dir>
</dir>
</dir>
</dir>
</dir>
</dir>
<b><font face="Times New Roman"><font size=+1>РАСПРОСТРАНЕНИЕ</font></font></b>
<dir>
<dir>
<dir>
<dir><font face="Times New Roman">Новейшую версию Nmap и RuNmap вы можете получить
по адресам</font>
<p><font face="Times New Roman"><a href="http://insecure.nm.ru">http://insecure.nm.ru</a></font>
<p><font face="Times New Roman"><a href="http://www.insecure.org">http://www.insecure.org</a></font>
<p><b>nmap</b><font face="Times New Roman"> (базовая версия) © 1997,1998,1999
Fyodor</font>
<p><b>runmap</b><font face="Times New Roman"> (русская версия) © 1999,2000
Алексей Волков</font>
<p><font face="Times New Roman">Библиотека </font><b>libcap</b><font face="Times New Roman">
распространяется совместно с Nmap. Владельцы авторского права: Van Jacobson,
Craig Leres и Steven McCanne, Национальная лаборатория Lawrence Berkley
Калифорнийского университета, Беркли, Калифорния. Версия, распространяемая
с Nmap, может быть модифицирована. Исходный код библиотеки можно получить
по адресу <a href="ftp://ftp.ee.lbl.gov/libcap.tar.gz.">ftp://ftp.ee.lbl.gov/libcap.tar.gz.</a></font>
<p><font face="Times New Roman">Эта программа является бесплатным программным
обеспечением. Вы можете свободно распространять и/или модифицировать ее
в соответствии с требованиями GNU General Public License, опубликованной
Free Software Foundation, версия 2. Если вас не устраивает данная лицензия,
мы (Insecure.Org) готовы рассмотреть ваши предложения.</font>
<p><font face="Times New Roman">Программа поставляется без предоставления
каких-либо гарантий. Вопросы и комментарии отправляйте по адресу:</font>
<p><a href="mailto:topcat@nm.ru">topcat@nm.ru</a>
<p><a href="mailto:topcat@nm.ru">topcat@nm.ru
<br>
</a>
<hr>
<p>© 2000<font face="Times New Roman"> Алексей Волков.</font></dir>
</dir>
</dir>
</dir>

</body>
</html>
